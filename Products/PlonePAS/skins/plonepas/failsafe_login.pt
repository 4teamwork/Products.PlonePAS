<tal:changes replace="nothing">
  default 'ac_name' and 'ac_password' to expected values
  set 'auth' to plugin instead of cookie crumbler
  'remember me' hidden if no such config
</tal:changes>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      i18n:domain="plone">
<head>
<script type="text/javascript">
<!--
function cookiesEnabled() {
    // set test cookie
    var c = "cookieTest=0";
    document.cookie = c;
    var dc = document.cookie;
    // cookie not set?  fail
    if (dc.indexOf(c) == -1) return 0;
    // change test cookie
    c = "cookieTest=1";
    document.cookie = c
    dc = document.cookie;
    // cookie not changed?  fail
    if (dc.indexOf(c) == -1) return 0;
    // delete cookie
    // document.cookie = "cookieTest=; expires=Thu, 01-Jan-70 00:00:01 GMT";
    return 1;
}
//-->
</script>
</head>

<body>

<div tal:define="auth nocall:here/acl_users/credentials_cookie_auth|nothing;
		 Iterator python:modules['Products.CMFPlone'].IndexIterator;
		 tabindex python:Iterator(pos=30000)">

<h1 i18n:translate="heading_sign_in">Please log in</h1>

<p i18n:translate="description_sign_in">
To access this part of the site, you need to log in with your user name and password.
</p>

<tal:nojoin tal:condition="nothing">
<p i18n:translate="description_no_account"
   tal:define="join python:[a['url'] for a in actions['user'] if a['id']=='join']"
   tal:condition="python: join and checkPermission('Add portal member', here)">

If you do not have an account here, head over to the

<span i18n:name="registration_form">
    <a href=""
       tal:attributes="href python:join.pop()"
       i18n:translate="description_no_account_registration_linktext">
        registration form
    </a>
</span>

to become a member.
</p>
</tal:nojoin>

<script type="text/javascript">
// <![CDATA[
   if (cookiesEnabled && !cookiesEnabled()) {
      document.writeln('<div class="portalMessage"><img src="info.gif" />Cookies are not enabled. You can not log in if they are turned off. <a href="enabling_cookies">How to enable cookies<'+'/a>.<'+'/div>');
   }
// ]]>
</script>

<div tal:condition="python:not auth" i18n:translate="failsafe_login_disabled">
      This feature is not available while cookie authentication is disabled.
</div>

<form action="logged_in"
      method="post"
      tal:condition="python: auth"
      tal:define="ac_name auth/name_cookie|string:__ac_name;
                  ac_password auth/pw_cookie|string:__ac_password;
                  ac_persist auth/persist_cookie|nothing;">

    <fieldset>

        <legend i18n:translate="legend_account_details">Account details</legend>

        <input type="hidden"
            name="came_from"
            value=""
	    tal:attributes="value request/came_from|request/HTTP_REFERER" />

        <div class="field">

            <label i18n:translate="label_user_name"
                   tal:attributes="for ac_name">User Name</label>

            <div i18n:translate="help_user_name_caps"
                 class="formHelp">
    		User names are case sensitive, make sure the caps lock key is not enabled.
            </div>

            <input type="text"
                   size="15"
                   tabindex=""
                   tal:attributes="name ac_name;
                                   id ac_name;
                                   value python:request.get(ac_name, '');
                                   tabindex tabindex/next;"
                   />

	</div>

	<div class="field">

            <label i18n:translate="label_password"
                   tal:attributes="for ac_password">Password</label>

            <div i18n:translate="help_capslock_password_retrieval"
                 class="formHelp">
                Case sensitive, make sure caps lock is not enabled.
                If you have forgotten your password,
                <a href="mail_password_form">click here to retrieve it</a>.
            </div>

            <input type="password"
                   size="15"
                   tabindex=""
                   tal:attributes="name ac_password;
                                   id ac_password;
                                   tabindex tabindex/next;"
                   />
	</div>

        <div class="field" tal:condition="ac_persist">

            <input type="checkbox"
                   class="noborder formRememberName"
                   value="1"
                   checked="checked"
                   id="cb_remember"
                   tabindex=""
                   tal:attributes="name ac_persist;
                                   tabindex tabindex/next;"
                   />

            <label for="cb_remember" i18n:translate="label_remember_my_name">Remember my name.</label>

            <div i18n:translate="help_remember_my_name"
                 class="formHelp">
                Check this to have your user name filled in automatically when you log in later.
            </div>

        </div>

        <div class="formControls">

            <input class="context"
                   tabindex=""
                   type="submit"
                   name="submit"
                   value="Log in"
                   i18n:attributes="value"
                   tal:attributes="tabindex tabindex/next;"
                   />

        </div>


        <p i18n:translate="remember_to_log_out">
            Please log out or exit your browser when you're done.
        </p>


    </fieldset>

</form>

</div>

</body>
</html>
